<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator - JavaScript Edition</title>
    <style>
        :root {
            --primary: #6d28d9;
            --secondary: #8b5cf6;
            --dark: #1e1b4b;
            --light: #f5f3ff;
            --accent: #c4b5fd;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .calculator {
            width: 340px;
            background-color: var(--dark);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        .display {
            padding: 16px;
            text-align: right;
            background-color: rgba(0, 0, 0, 0.3);
            height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }
        
        .history {
            font-size: 16px;
            color: var(--accent);
            opacity: 0.8;
            min-height: 20px;
            max-height: 60px;
            overflow-y: auto;
            text-align: right;
        }
        
        .current {
            font-size: 40px;
            font-weight: 700;
            color: white;
            min-height: 60px;
        }
        
        .theme-toggle {
            position: absolute;
            top: 10px;
            left: 10px;
            color: var(--light);
            font-size: 20px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .btn {
            border: none;
            background-color: var(--dark);
            padding: 20px;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        
        .btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .btn:active {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }
        
        .btn.special {
            background-color: var(--primary);
        }
        
        .btn.operator {
            background-color: var(--secondary);
        }
        
        .btn.equals {
            background-color: var(--success);
            grid-column: span 2;
        }
        
        .btn.clear {
            background-color: var(--danger);
        }
        
        .btn.backspace {
            background-color: var(--warning);
        }
        
        .memory-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            display: none;
        }
        
        .dark-mode {
            --primary: #3b82f6;
            --secondary: #60a5fa;
            --dark: #1f2937;
            --light: #f9fafb;
            --accent: #93c5fd;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }
        
        .dark-mode body {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        
        .calculator.scientific {
            width: 480px;
        }
        
        .scientific-toggle {
            position: absolute;
            top: 10px;
            left: 50px;
            color: var(--light);
            font-size: 20px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .scientific-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .scientific-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background-color: rgba(0, 0, 0, 0.2);
            height: 0;
            overflow: hidden;
            transition: height 0.3s ease;
        }
        
        .scientific-buttons.visible {
            height: auto;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="display">
            <div class="theme-toggle">‚òÄÔ∏è</div>
            <div class="scientific-toggle">üßÆ</div>
            <div class="memory-indicator">M</div>
            <div class="history"></div>
            <div class="current">0</div>
        </div>
        
        <div class="scientific-buttons">
            <button class="btn special" data-action="sin">sin</button>
            <button class="btn special" data-action="cos">cos</button>
            <button class="btn special" data-action="tan">tan</button>
            <button class="btn special" data-action="pow">x^y</button>
            
            <button class="btn special" data-action="log">log</button>
            <button class="btn special" data-action="ln">ln</button>
            <button class="btn special" data-action="sqrt">‚àö</button>
            <button class="btn special" data-action="exp">e^x</button>
            
            <button class="btn special" data-action="pi">œÄ</button>
            <button class="btn special" data-action="e">e</button>
            <button class="btn special" data-action="abs">|x|</button>
            <button class="btn special" data-action="fact">x!</button>
        </div>
        
        <div class="buttons">
            <button class="btn clear" data-action="clear">AC</button>
            <button class="btn backspace" data-action="backspace">‚å´</button>
            <button class="btn special" data-action="percent">%</button>
            <button class="btn operator" data-action="divide">√∑</button>
            
            <button class="btn" data-num="7">7</button>
            <button class="btn" data-num="8">8</button>
            <button class="btn" data-num="9">9</button>
            <button class="btn operator" data-action="multiply">√ó</button>
            
            <button class="btn" data-num="4">4</button>
            <button class="btn" data-num="5">5</button>
            <button class="btn" data-num="6">6</button>
            <button class="btn operator" data-action="subtract">-</button>
            
            <button class="btn" data-num="1">1</button>
            <button class="btn" data-num="2">2</button>
            <button class="btn" data-num="3">3</button>
            <button class="btn operator" data-action="add">+</button>
            
            <button class="btn" data-num="0">0</button>
            <button class="btn" data-num=".">.</button>
            <button class="btn equals" data-action="calculate">=</button>
        </div>
    </div>

    <script>
        class Calculator {
            constructor() {
                // DOM elements
                this.display = document.querySelector('.display');
                this.historyDisplay = document.querySelector('.history');
                this.currentDisplay = document.querySelector('.current');
                this.buttons = document.querySelector('.buttons');
                this.scientificButtons = document.querySelector('.scientific-buttons');
                this.calculatorEl = document.querySelector('.calculator');
                this.themeToggle = document.querySelector('.theme-toggle');
                this.scientificToggle = document.querySelector('.scientific-toggle');
                this.memoryIndicator = document.querySelector('.memory-indicator');
                
                // Calculator state
                this.current = '0';
                this.previous = '';
                this.operation = undefined;
                this.resetDisplay = false;
                this.memory = 0;
                this.history = [];
                this.darkMode = false;
                this.scientificMode = false;
                
                this.bindEvents();
                this.updateDisplay();
            }
            
            bindEvents() {
                document.querySelectorAll('[data-num]').forEach(button => {
                    button.addEventListener('click', () => this.appendNumber(button.getAttribute('data-num')));
                });
                
                document.querySelectorAll('[data-action]').forEach(button => {
                    button.addEventListener('click', () => {
                        const action = button.getAttribute('data-action');
                        
                        switch (action) {
                            case 'add':
                            case 'subtract':
                            case 'multiply':
                            case 'divide':
                                this.chooseOperation(action);
                                break;
                            case 'calculate':
                                this.compute();
                                break;
                            case 'clear':
                                this.clear();
                                break;
                            case 'backspace':
                                this.backspace();
                                break;
                            case 'percent':
                                this.percent();
                                break;
                            case 'sin':
                                this.sin();
                                break;
                            case 'cos':
                                this.cos();
                                break;
                            case 'tan':
                                this.tan();
                                break;
                            case 'log':
                                this.log();
                                break;
                            case 'ln':
                                this.ln();
                                break;
                            case 'sqrt':
                                this.sqrt();
                                break;
                            case 'pow':
                                this.pow();
                                break;
                            case 'exp':
                                this.exp();
                                break;
                            case 'pi':
                                this.pi();
                                break;
                            case 'e':
                                this.e();
                                break;
                            case 'abs':
                                this.abs();
                                break;
                            case 'fact':
                                this.factorial();
                                break;
                        }
                    });
                });
                
                document.addEventListener('keydown', (e) => {
                    if ((e.key >= '0' && e.key <= '9') || e.key === '.') {
                        this.appendNumber(e.key);
                    }
                    if (e.key === '+') this.chooseOperation('add');
                    if (e.key === '-') this.chooseOperation('subtract');
                    if (e.key === '*') this.chooseOperation('multiply');
                    if (e.key === '/') {
                        e.preventDefault();
                        this.chooseOperation('divide');
                    }
                    if (e.key === 'Enter' || e.key === '=') this.compute();
                    if (e.key === 'Escape') this.clear();
                    if (e.key === 'Backspace') this.backspace();
                    if (e.key === '%') this.percent();
                });
                
                // Theme toggle
                this.themeToggle.addEventListener('click', () => {
                    this.darkMode = !this.darkMode;
                    document.body.classList.toggle('dark-mode', this.darkMode);
                    this.themeToggle.textContent = this.darkMode ? 'üåô' : '‚òÄÔ∏è';
                });
                
                // Scientific mode toggle
                this.scientificToggle.addEventListener('click', () => {
                    this.scientificMode = !this.scientificMode;
                    this.calculatorEl.classList.toggle('scientific', this.scientificMode);
                    this.scientificButtons.classList.toggle('visible', this.scientificMode);
                });
            }
            
            appendNumber(number) {
                if (this.resetDisplay) {
                    this.current = '';
                    this.resetDisplay = false;
                }
                
                if (number === '.' && this.current.includes('.')) return;

                if (this.current === '0' && number !== '.') {
                    this.current = number;
                } else {
                    this.current += number;
                }
                
                this.updateDisplay();
            }
            
            chooseOperation(operation) {
                if (this.current === '') return;
                
                if (this.previous !== '') {
                    this.compute();
                }
                
                this.operation = operation;
                this.previous = this.current;
                this.current = '';
                this.updateDisplay();
            }
            
            compute() {
                let computation;
                const prev = parseFloat(this.previous);
                const current = parseFloat(this.current);
                
                if (isNaN(prev) || isNaN(current)) return;
                
                switch (this.operation) {
                    case 'add':
                        computation = prev + current;
                        break;
                    case 'subtract':
                        computation = prev - current;
                        break;
                    case 'multiply':
                        computation = prev * current;
                        break;
                    case 'divide':
                        if (current === 0) {
                            this.current = 'Error';
                            this.previous = '';
                            this.operation = undefined;
                            this.updateDisplay();
                            return;
                        }
                        computation = prev / current;
                        break;
                    default:
                        return;
                }
                
                const operationSymbol = {
                    add: '+',
                    subtract: '-',
                    multiply: '√ó',
                    divide: '√∑'
                }[this.operation];
                
                const historyEntry = `${prev} ${operationSymbol} ${current} = ${computation}`;
                this.history.push(historyEntry);
                if (this.history.length > 3) this.history.shift();
                
                this.current = computation.toString();
                this.operation = undefined;
                this.previous = '';
                this.resetDisplay = true;
                this.updateDisplay();
            }
            
            updateDisplay() {
                this.currentDisplay.textContent = this.current;
                
                if (this.operation) {
                    const operationSymbol = {
                        add: '+',
                        subtract: '-',
                        multiply: '√ó',
                        divide: '√∑'
                    }[this.operation];
                    
                    this.historyDisplay.textContent = `${this.previous} ${operationSymbol}`;
                } else {
                    this.historyDisplay.textContent = this.history.length > 0 ? this.history[this.history.length - 1] : '';
                }
                
                this.memoryIndicator.style.display = this.memory !== 0 ? 'block' : 'none';
            }
            
            clear() {
                this.current = '0';
                this.previous = '';
                this.operation = undefined;
                this.updateDisplay();
            }
            
            backspace() {
                if (this.current === '0' || this.current === 'Error' || this.resetDisplay) {
                    this.current = '0';
                    this.resetDisplay = false;
                } else {
                    this.current = this.current.slice(0, -1) || '0';
                }
                this.updateDisplay();
            }
            
            percent() {
                this.current = (parseFloat(this.current) / 100).toString();
                this.updateDisplay();
            }
    
            sin() {
                this.current = Math.sin(parseFloat(this.current)).toString();
                this.updateDisplay();
            }
            
            cos() {
                this.current = Math.cos(parseFloat(this.current)).toString();
                this.updateDisplay();
            }
            
            tan() {
                this.current = Math.tan(parseFloat(this.current)).toString();
                this.updateDisplay();
            }
            
            log() {
                if (parseFloat(this.current) <= 0) {
                    this.current = 'Error';
                } else {
                    this.current = Math.log10(parseFloat(this.current)).toString();
                }
                this.updateDisplay();
            }
            
            ln() {
                if (parseFloat(this.current) <= 0) {
                    this.current = 'Error';
                } else {
                    this.current = Math.log(parseFloat(this.current)).toString();
                }
                this.updateDisplay();
            }
            
            sqrt() {
                if (parseFloat(this.current) < 0) {
                    this.current = 'Error';
                } else {
                    this.current = Math.sqrt(parseFloat(this.current)).toString();
                }
                this.updateDisplay();
            }
            
            pow() {
                this.chooseOperation('pow');
                // Special handling happens in compute()
            }
            
            exp() {
                this.current = Math.exp(parseFloat(this.current)).toString();
                this.updateDisplay();
            }
            
            pi() {
                this.current = Math.PI.toString();
                this.updateDisplay();
            }
            
            e() {
                this.current = Math.E.toString();
                this.updateDisplay();
            }
            
            abs() {
                this.current = Math.abs(parseFloat(this.current)).toString();
                this.updateDisplay();
            }
            
            factorial() {
                const num = parseInt(this.current);
                if (num < 0) {
                    this.current = 'Error';
                } else {
                    let result = 1;
                    for (let i = 2; i <= num; i++) {
                        result *= i;
                    }
                    this.current = result.toString();
                }
                this.updateDisplay();
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            new Calculator();
        });
    </script>
</body>
</html>
